<!DOCTYPE html>
<html>
<!--
File:	LSC/map.html
Author:	Bob Walton ( walton@acm.org )
Date:	Mon Feb 20 11:28:56 EST 2023
-->

<head>

<meta http-equiv="Cache-Control"
      content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

</head>
<body>

<h1>Please Wait<br>Determining Location</h1>

<script>

const zoom = '15.25';

const options = {
  enableHighAccuracy: true,
  timeout: 10000,
  maximumAge: 0
};

if ( ! 'geolocation' in navigator )
{
    alert ( 'Geolocation NOT Available' );

    window.location.assign ( 'https://trails.actonma.gov/map/' );
}

navigator.geolocation.getCurrentPosition
    ( storePosition, positionError, options );

function storePosition ( position )
{
    let x = position.coords.longitude;
    let y = position.coords.latitude;

    let src = 'https://trails.actonma.gov/map/'
	+ '?zoom=' + zoom
	+ '&lng=' + x
	+ '&lat=' + y
	+ '&m=[{%22t%22:%22You%20Are%20Here%22'
	+ ',%22x%22:%22' + x + '%22'
	+ ',%22y%22:%22' + y + '%22'
	+ '}]';

    window.location.assign ( src );
}

function positionError ()
{
    alert ( 'Position Not Available' );

    window.location.assign ( 'https://trails.actonma.gov/map/' );
}

</script>

</body>
</html>
